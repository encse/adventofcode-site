This has been a hard but beautiful problem that took me the longest time
to implement, just to see that it has a super elegant solution given
the special properties of the input.

I don't have to say anything else, because the code is well commented.